function CreateTable(a){var b=a.results,c=b.data;$("#myTable").show(),table=$("#myTable").DataTable({data:c,order:[2,"asc"],orderClasses:!0,lengthChange:!0,lengthMenu:[10,25,50,75,100],columns:[{type:"string",data:"artist"},{type:"string",data:"venue"},{type:"date",data:"date"},{type:"num-fmt",data:"price"}],language:{searchPlaceholder:"",sSearch:"",infoEmpty:"Nothing to see...",infoFiltered:"",info:"Showing page _PAGE_ of _PAGES_",infoPostFix:" (_MAX_ total records)",sLengthMenu:"_MENU_"},paging:!0,pagingType:"simple",autoWidth:!0,scrollCollapse:!0,responsive:!0,stateSave:!1,stateSaveParams:function(a,b){b.search.search=""}});var d=document.getElementById("myTable_filter").firstChild,e=d.firstChild;e.setAttribute("id","search_table"),e.setAttribute("type","text"),e.setAttribute("tabindex","0"),e.setAttribute("title","Live filter, Esc to clear"),e.setAttribute("autofocus",""),e.setAttribute("placeholder","Filter shows by any column"),$("#loading").hide(),CreateTimeStamp(a)}function CreateTimeStamp(a){var b=a.results.site[0].updateDate,c=a.results.site[0].updateTime,d=a.results.site[0].source.alt,e=a.results.site[0].source.href,f={"%DAY%":b,"%TIME%":c,"%SITE%":d,"%URL%":e};str="<code>Last Updated: %DAY% @ %TIME% by</code><a class='update-link' href='%URL%'> %SITE%</a>",updateString=str.replace(/%\w+%/g,function(a){return f[a]||a}),$("#update-header").html(updateString),$("#update-footer").html(updateString)}function GoogleMapVenue_click(a){toastr.clear(),address=a.search(/Danforth Music/i)>=0?"The Music Hall":a;var b={location:toronto,name:address,radius:1e4},c=new google.maps.places.PlacesService(map);c.nearbySearch(b,PlacesCallback)}function PlacesCallback(a,b){for(var c=0;c<markers.length;c++)markers[c].setMap(null);b==google.maps.places.PlacesServiceStatus.OK?(createMarker(a[0]),$("#map-canvas").visible()||$.smoothScroll("map-canvas")):toastr.warning("<div class='toast-extra'>Click here to search it</div>",address+" not found")}function createMarker(a){var b=(a.geometry.location,new google.maps.Marker({map:map,animation:google.maps.Animation.DROP,position:a.geometry.location}));map.setZoom(14),map.setCenter(b.getPosition()),markers.push(b),google.maps.event.addListener(b,"click",function(){infowindow.setContent("<div class='info-window'><b>"+a.name+"</b><br>"+a.vicinity+"</div>"),infowindow.open(map,this)}),google.maps.event.addListener(map,"resize",function(){window.setTimeout(function(){map.panTo(b.getPosition())},400)})}function VenueSearch(){var a="http://google.ca/search?q=toronto+"+encodeURIComponent(address.replace(/&amp;/g,"&"));window.open(a)}var map,infowindow,markers=[],address,toronto,table;$(document).ready(function(){function a(a,b){var c=document.createElement("div");c.style.backgroundColor="#fff",c.style.border="2px solid #fff",c.style.borderRadius="3px",c.style.boxShadow="0 2px 6px rgba(0,0,0,.3)",c.style.cursor="pointer",c.style.marginBottom="25px",c.style.marginLeft="0px",c.style.textAlign="center",c.title="Expand",a.appendChild(c);var d=document.createElement("div");d.style.color="rgb(25,25,25)",d.style.fontFamily="Roboto,Arial,sans-serif",d.style.fontSize="10px",d.style.lineHeight="25px",d.style.paddingLeft="5px",d.style.paddingRight="5px",d.innerHTML="Expand",c.appendChild(d),google.maps.event.addDomListener(c,"click",function(){currentCenter=b.getCenter(),200==$("#map-canvas").height()?($("#map-canvas").animate({height:"300px"},{queue:!1,duration:500}),window.setTimeout(function(){b.panTo(currentCenter)},500)):$("#map-canvas").animate({height:"200px"},{queue:!1,duration:500})})}var b=["background.jpg","background2.jpg","background3.jpg","background4.jpg","background5.jpg"];$("body").css({"background-image":"url(images/"+b[Math.floor(Math.random()*b.length)]+")"}),toastr.options={progressBar:!1,closeButton:!0,positionClass:"toast-bottom-center",onclick:VenueSearch},toronto=new google.maps.LatLng(43.65,-79.34);var c={center:toronto,zoomControl:!0,streetViewControl:!0,zoom:11};infowindow=new google.maps.InfoWindow,map=new google.maps.Map(document.getElementById("map-canvas"),c);{var d=document.createElement("div");new a(d,map)}d.index=1,map.controls[google.maps.ControlPosition.BOTTOM_LEFT].push(d),$(window).resize(function(){google.maps.event.trigger(map,"resize")});var e=$.ajax({beforeSend:function(){$("#loading").show()},url:"https://www.kimonolabs.com/api/69auren6?&apikey=8mJuGzeHSesPIM93SJ19pXgAuLx9sxEE&kimmodify=1",dataType:"jsonp",timeout:5e3,success:CreateTable,error:function(a,b){console.log(b),e.abort(),toastr.warning("Using local cached copy","Unable to load data"),$.ajax({url:"data/kimonoData.json",dataType:"json",success:CreateTable})}})}),$(function(){$("html").keydown(function(a){37==a.which?$("#myTable_previous").click():39==a.which?$("#myTable_next").click():27==a.which&&$("#search_table").val("")})});